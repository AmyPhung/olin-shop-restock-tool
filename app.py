import os
from flask import Flask, request, redirect, url_for, render_template, send_from_directory
from werkzeug.utils import secure_filename
from PyPDF2 import PdfFileReader, PdfFileWriter
from shutil import copyfile



test_list = ['a', 'b', 'c']

app = Flask(__name__, static_url_path="/static")

@app.route('/', methods=['GET'])
def index():
    return render_template('index.html', t_set=test_list)

# QR Code Output Paste
# @app.route('/', methods=['POST'])
# def submit():
#     print('You entered: {}'.format(request.form['text']))
#     return render_template('index.html')
# @app.route('/click/', methods=['GET', 'POST'])#, methods=['POST', 'GET'])#, methods = ['GET'])
# def test_form():
#     if request.method == 'POST':
#         print ("box")
#         print(request.form["exampleFormControlTextarea1"])
#     return "asdf2"
#
@app.route('/', methods=['POST'])
def handleFormData():
    # return 'You entered: {}'.format(request.form['text'])
    print(request.form.getlist('exampleFormControlSelect2'))
    # print("hello world")
    return render_template('index.html', t_set=test_list)

@app.route('/pdf_down', methods=['GET'])
def pdfPage():
    return render_template('pdf_down.html')



@app.route('/download', methods=['GET'])
def downloadPdf():
    print("hello")
    return send_from_directory(directory='output', filename='autogenerated_labels.pdf')

@app.route('/upload', methods=['GET'])
def uploadFile():
    filename = "output/autogenerated_labels.pdf"
    # with f as open(filename):
    copyfile(filename, "output/autogenerated_labels2.pdf")

    return redirect(url_for('downloadPdf'))

#
#
# # Labels -----------------------------------------------------------------------
# UPLOAD_FOLDER = os.path.dirname(os.path.abspath(__file__)) + '/uploads/'
# DOWNLOAD_FOLDER = os.path.dirname(os.path.abspath(__file__)) + '/downloads/'
# ALLOWED_EXTENSIONS = {'pdf'}
#
# DIR_PATH = os.path.dirname(os.path.realpath(__file__))
# app.config['UPLOAD_FOLDER'] = UPLOAD_FOLDER
# app.config['DOWNLOAD_FOLDER'] = DOWNLOAD_FOLDER
# # limit upload size upto 8mb
# app.config['MAX_CONTENT_LENGTH'] = 8 * 1024 * 1024
#
# def allowed_file(filename):
#     return '.' in filename and filename.rsplit('.', 1)[1].lower() in ALLOWED_EXTENSIONS
